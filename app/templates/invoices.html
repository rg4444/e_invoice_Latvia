{% extends "base.html" %}
{% block content %}
<h2>Invoices</h2>
<div class="mb-3">
  <button id="fetchSchemas" class="btn btn-primary">Fetch Schemes</button>
</div>
<table class="table table-striped">
  <thead><tr><th>Name</th><th>Size</th><th>Modified</th><th>Actions</th></tr></thead>
  <tbody>
    {% for f in files %}
    <tr>
      <td>{{ f.name }}</td>
      <td>{{ f.size }}</td>
      <td>{{ f.mtime }}</td>
      <td>
        <a href="/invoice/download?path={{ f.path }}" class="btn btn-sm btn-secondary">Download</a>
      </td>
    </tr>
    {% endfor %}
    {% if files|length == 0 %}
    <tr><td colspan="4"><em>No invoices yet. Generate one from the Invoice tab.</em></td></tr>
    {% endif %}
  </tbody>
</table>
<script>
document.getElementById('fetchSchemas').addEventListener('click', async ()=>{
  const res = await fetch('/fetch-schemas', {method:'POST'}).then(r=>r.json());
  if(res.ok){
    alert('Schemas fetched');
  } else {
    alert('Failed: ' + (res.error || ''));
  }
});
</script>
{% endblock %}
